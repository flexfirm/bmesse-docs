# Bメッセ V1.0 - オペレーターガイド
オペレーター向けにチャット機能の使い方をガイドします。

##目次
[用語](#用語)   
[チャットルームについて](#チャットルームについて)  
　　・[ヘッダー部分](#ヘッダー部分)  
　　・[スレッド部分](#スレッド部分)  
　　・[メッセージの入力と送信部分](#メッセージの入力と送信部分)  
　　・[アプリユーザーの状態](#アプリユーザーの状態)  
[アプリユーザー側の画面について](#アプリユーザー側の画面について)  
　　・[ヘッダー部分](#ヘッダー部分_アプリ)  
　　・[スレッド部分](#スレッド部分_アプリ)  
　　・[オペレーターの状態](#オペレーターの状態)  
　　・[アプリユーザーによるメッセージ削除](#アプリユーザーによるメッセージ削除)  

<h2 id="用語">用語</h2>

### チャットに関わるユーザー
アプリユーザーは、アプリからチャット機能を使用し、オペレーターはWebクライアントから使用します。
アプリユーザーとオペレーターは、オンライン、オフラインのどちらかの状態にいるよう制御され、それぞれの状態によってできることや、チャット相手の表示が変わります。
オペレーターはオンラインの一種として、相談中という状態も持ちます。これはオンラインであるが、応対できるアプリユーザーの上限に達している状態です。

### メッセージ
アプリユーザーとオペレーターの間で都度、送受信されるテキスト等をさします。

### スレッド
メッセージを送受信するために確立された特定のアプリユーザーとオペレーターの繋がり、およびそこでやり取りされた一連のメッセージを指します。

### チャットルーム
特定のアプリユーザーとオペレータの間でスレッドが共有され、メッセージの送受信ができる画面を指します。
また、アプリユーザーとオペレーターはそれぞれ、チャット中、書き込み中、退出中など、チャットルーム内での状態を持ち、相手方に表示されます。

<h2 id="チャットルームについて">チャットルームについて</h2>

![Bメッセ](https://github.com/flexfirm/bmesse-docs/raw/img_branch/img/chat_ui.PNG?raw=true)

<h3 id="ヘッダー部分">ヘッダー部分</h3>
アプリユーザーの名前と、アプリユーザーの状態が表示されます。  
～概要～  
	<dl>
		<dt>（●チャット中）</dt>
		<dd>アプリユーザーの現在の状態を表しています。</dd>
		<dt>（切断ボタン）</dt>
		<dd>アプリユーザーとのチャットを終了することができます。</dd>
		<dt>（1/2）</dt>
		<dd>現在あなたとチャット中のユーザー / あなたが設定した同時にチャット可能な人数  
			を表します。  
			チャット中のユーザーが多い場合、分子が分母より大きくなる場合があります。  
		</dd>
	</dl>

<h3 id="スレッド部分">スレッド部分</h3>
アプリユーザーとあなたが送受信したメッセージが、上から下へ時系列に表示されます。  
	<dl>
		<dt>（左側）</dt>
		<dd>アプリユーザー</dd>
		<dt>（右側）</dt>
		<dd>あなた</dd>
	</dl>
メッセージの吹き出し下に、送信された時間が、その下には「既読」が表示されます。  

<h3 id="メッセージの入力と送信部分">メッセージの入力と送信部分</h3>
テキスト欄にメッセージを入力し、「送信」ボタンによって送信することができます。  

<h3 id="アプリユーザーの状態">アプリユーザーの状態</h3>

<h4 id="チャット中">●チャット中</h4>
アプリユーザーがあなたのチャットルームに入ると、あなたの画面に「チャット中」と表示されます。  
この時あなたが「オフライン」か「相談中」でなければ、アプリユーザーの画面には「チャット中」と表示されます。  
つまりアプリユーザーは「あなたとチャットを始めた」と思っていますので、メッセージの返答は即座にすることが好ましいです。  
あなたが__「オフライン」か「相談中」__である場合は、アプリユーザーには「チャット中」の表示されません。  
なお、これらの状態の時にアプリユーザーがメッセージを送信した場合は、システムが以下のような__自動返信__を行います。  

__自動返信__  
_「～システムより自動返信～  
現在オフライン中、または他の方とご相談中のため、返信にお時間がかかります。  
ご容赦くださいませ」_  

__メールによる通知__  
システムによる自動返信が行われた場合、それを知らせる旨のメールがあなたへ（登録アドレスへ）送信されます。  

__Push通知__  
アプリユーザーが「チャット中」ではない場合にあなたがメッセージを送信した場合、アプリユーザーにPush通知が送信されます。  

__URLの自動リンク__  
メッセージ内にURLがある場合、自動でそれを判別し、リンク化します。  

__書込み中__  
アプリユーザーがあなたのチャットルームで何かを書き込もうとした時に「書込み中」になります。  
この時、メッセージのやり取りの最下部に書込み中の吹き出しが表示されます。  

<h4 id="退出中">●退出中</h4>
アプリユーザーがあなたのチャットルームから退出した場合、またはあなたが「切断」ボタンを押した場合に「退出中」と表示されます。  
なお、「切断」ボタンを押した場合、アプリユーザーは強制的にチャットルームから退出させられることはありません。  

<h2 id="アプリユーザー側の画面について">アプリユーザー側の画面について</h2>
![Bメッセ](https://github.com/flexfirm/bmesse-docs/blob/img_branch/img/chat_ui_ios.jpg?raw=true)  

<h3 id="ヘッダー部分_アプリ">ヘッダー部分</h3>
あなたの状態が表示されます。  
	<dl>
		<dt>（竹内あさこ）</dt>
		<dd>あなたの名前が表示されます。</dd>
		<dt>（●チャット中）</dt>
		<dd>あなたの現在の状態が表示されます。</dd>
	</dl>


<h3 id="スレッド部分_アプリ">スレッド部分</h3>
アプリユーザーとあなたが送受信したメッセージが、上から下へ時系列に表示されます。  
	<dl>
		<dt>（左側）</dt>
		<dd>あなた</dd>
		<dt>（右側）</dt>
		<dd>アプリユーザー</dd>
	</dl>
メッセージの吹き出し下に、送信された時間が、その下には「既読」が表示されます。  

<h3 id="オペレーターの状態">オペレーターの状態</h3>
アプリユーザーに見える、あなたの状態です  
<h4 id="オフラインオンライン_アプリ">●オフラインオンライン</h4>
チャット中、書込み中、退出中、相談中などの、「オフライン」以外の時は全て「オンライン」状態です。  

<h4 id="チャット中_アプリ">●チャット中</h4>
あなたが「オンライン」の状態の時に、チャットルームに入ると、アプリユーザー側に「チャット中」と表示されます。  

<h4 id="書込み中">●書込み中</h4>
あなたがテキストボックスにカーソルを当てた時点で、アプリユーザーには「書込み中」と表示されます。  

<h4 id="退出中_アプリ">●退出中</h4>
あなたがオフラインの時は「退出中」と表示されます。  
また、あなたがオンラインの時でも、チャットルームに入っていなければ、そのチャットルームでは「退出中」と表示されます。  

<h4 id="相談中_アプリ">●相談中</h4>
あなたが、同時に相談できる人数の上限までチャットしている状態です。  
このときでも、アプリユーザーはあなたのチャットルームに入って、メッセージを送信することもできますが、システムより返信が直ぐにできない旨の自動返信メッセージが表示されます。  

<h3 id="アプリユーザーによるメッセージ削除">アプリユーザーによるメッセージ削除</h3>
アプリユーザーは自身のメッセージを削除することができます。  
これはアプリユーザーが誤って個人情報などを送信してしまった場合に備えた機能で、アプリユーザーのための機能です。  
PC側にこの機能はありません。  
削除されたメッセージは以下のように表示されます。  

「～このメッセージは削除されました～」  
